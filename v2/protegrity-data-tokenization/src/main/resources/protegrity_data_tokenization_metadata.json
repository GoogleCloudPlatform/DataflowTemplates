{
  "name": "Protegrity Data Tokenization",
  "description": "Tokenizes structured plain text data from GCS or Pub/Sub and ingests it to GCS, BigTable or BigQuery using an external API calls to Protegrity DSG",
  "parameters": [
    {
      "name": "dataSchemaGcsPath",
      "label": "GCS location of your data schema",
      "helpText": "Path to data schema (JSON format) in GCS compatible with BigQuery",
      "paramType": "GCS_READ_FILE",
      "isOptional": false,
      "regexes": [
        "^gs:\\/\\/[^\\n\\r]+$"
      ]
    },
    {
      "name": "inputGcsFilePattern",
      "label": "GCS filepattern for input files",
      "helpText": "GCS filepattern for files in bucket to read data from",
      "paramType": "GCS_READ_FILE",
      "isOptional": true,
      "regexes": [
        "^gs:\\/\\/[^\\n\\r]+$"
      ]
    },
    {
      "name": "inputGcsFileFormat",
      "label": "File format of input files",
      "helpText": "File format of input files. Supported formats: JSON, CSV",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^(JSON|CSV|AVRO)$"
      ]
    },
    {
      "name": "csvContainsHeaders",
      "label": "If file(s) contain headers",
      "helpText": "`true` if file(s) in bucket to read data from contain headers, and `false` otherwise",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^(true|false)$"
      ]
    },
    {
      "name": "csvDelimiter",
      "label": "Delimiting character in CSV",
      "helpText": "Delimiting character in CSV. Default: use delimiter provided in csvFormat",
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "csvFormat",
      "label": "Csv format according to Apache Commons CSV format",
      "helpText": "Csv format according to Apache Commons CSV format. Default is: Apache Commons CSV default\nhttps://static.javadoc.io/org.apache.commons/commons-csv/1.7/org/apache/commons/csv/CSVFormat.html#DEFAULT\nMust match format names exactly found at: https://static.javadoc.io/org.apache.commons/commons-csv/1.7/org/apache/commons/csv/CSVFormat.Predefined.html",
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "pubsubTopic",
      "label": "Pub/Sub input topic",
      "helpText": "The Cloud Pub/Sub topic to read from",
      "paramType": "PUBSUB_TOPIC",
      "isOptional": true,
      "regexes": [
        "^projects\\/[a-z][-a-z0-9:.]{4,61}[a-z0-9]\\/topics\\/[^\\n\\r\\/]+$"
      ]
    },
    {
      "name": "dsgUri",
      "label": "URI of the DSG",
      "helpText": "URI for the API calls to DSG",
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "batchSize",
      "label": "Size of the batch",
      "helpText": "Size of the batch to send to DSG per request",
      "regexes": [
        "^[0-9]*$"
      ],
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "payloadConfigGcsPath",
      "label": "GCS path to the payload config",
      "helpText": "GCS path to the payload configuration file with an array of fields to extract for tokenization",
      "paramType": "GCS_READ_FILE",
      "isOptional": true,
      "regexes": [
        "^gs:\\/\\/[^\\n\\r]+$"
      ]
    },
    {
      "name": "nonTokenizedDeadLetterGcsPath",
      "label": "GCS path for Dead letter elements",
      "helpText": "GCS folder where failed to tokenize data will be stored",
      "paramType": "GCS_WRITE_FOLDER",
      "isOptional": true,
      "regexes": [
        "^gs:\\/\\/[^\\n\\r]+$"
      ]
    },
    {
      "name": "outputGcsDirectory",
      "label": "GCS directory for output files",
      "helpText": "GCS directory in bucket to write data to",
      "paramType": "GCS_WRITE_FILE",
      "isOptional": true,
      "regexes": [
        "^gs:\\/\\/[^\\n\\r]+$"
      ]
    },
    {
      "name": "outputGcsFileFormat",
      "label": "File format of output files",
      "helpText": "File format of output files. Supported formats: JSON, CSV",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^(JSON|CSV|AVRO)$"
      ]
    },
    {
      "name": "windowDuration",
      "label": "The window duration in which data will be written.",
      "helpText": "The window duration in which data will be written. Should be specified only for 'Pub/Sub -> GCS' case.\nDefaults to 30s.\nAllowed formats are:\n Ns (for seconds, example: 5s),\n Nm (for minutes, example: 12m),\n Nh (for hours, example: 2h).",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^([0-9]+[smh])$"
      ]
    },
    {
      "name": "bigQueryTableName",
      "label": "Name of the output BigQuery table",
      "helpText": "Cloud BigQuery table name to write into",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": []
    },
    {
      "name": "bigTableProjectId",
      "label": "Id of the project with output BigTable instance",
      "helpText": "Id of the project where the Cloud BigTable instance to write into is located",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^[a-z][-a-z0-9:.]{4,61}[a-z0-9]$"
      ]
    },
    {
      "name": "bigTableInstanceId",
      "label": "Id of the output BigTable instance",
      "helpText": "Id of the Cloud BigTable instance to write into",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^[a-z][a-z0-9\\-]{4,31}[a-z0-9]$"
      ]
    },
    {
      "name": "bigTableTableId",
      "label": "Id of the output BigTable table",
      "helpText": "Id of the Cloud BigTable table to write into",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^[_a-zA-Z0-9][-_.a-zA-Z0-9]*$"
      ]
    },
    {
      "name": "bigTableKeyColumnName",
      "label": "Key column name for the output BigTable table",
      "helpText": "Column name to use as a key in Cloud BigTable",
      "paramType": "TEXT",
      "isOptional": true
    },
    {
      "name": "bigTableColumnFamilyName",
      "label": "Column family name for the output BigTable table",
      "helpText": "Column family name to use in Cloud BigTable",
      "paramType": "TEXT",
      "isOptional": true,
      "regexes": [
        "^[_a-zA-Z0-9][-_.a-zA-Z0-9]*$"
      ]
    }
  ]
}
